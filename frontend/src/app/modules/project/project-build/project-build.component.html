<div *ngIf="isLoading; then loading; else loaded;"></div>

<ng-template #loading>
  <app-loading-spinner margin="170px auto" size="20px"></app-loading-spinner>
</ng-template>

<ng-template #loaded>

<div *ngIf="buildHistory; else emptyBuilds">
  <nav aria-label="breadcrumb" *ngIf="!isCurrent">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a routerLink="../">Show all</a></li>
    </ol>
  </nav>
  <div class="build" [appBuildHistoryStatusOutline]="buildHistory.buildStatus">
    <div class='user-commit'>
      <a [ngClass]="{'disabled-link': buildHistory?.performer?.username == 'BuilderBot'}" [routerLink]="'/portal/user/' + buildHistory.performer?.id">
        <img
          [src]="buildHistory.performer?.avatarUrl"
          onerror="this.src='../../../../assets/images/Avatar-default.png'"
          alt="Avatar"
          class="avatar" />Author: {{buildHistory.performer?.username}}
      </a>
      <p><i class="fas fa-code"></i> Commit
        <span class="commit" *ngIf="repository?.url && buildHistory?.commitHash; else notLink;">
          <a class="commit-link" target="_blank" [href]="repository?.url+'/commit/'+buildHistory?.commitHash">{{ getCommit(buildHistory) }}</a>
        </span>
        <ng-template #notLink>
          <span> — </span>
        </ng-template>
      </p>
      <p><i class="fas fa-code-branch"></i> Branch
        <span *ngIf="repository?.url && buildHistory?.branchHash; else noBranchLink;" class="branch">
        <a class="commit-link" target="_blank" [href]="repository?.url+'/tree/'+buildHistory?.branchHash">{{buildHistory?.branchHash}}</a>
        </span><ng-template #noBranchLink>
          <span> — </span>
        </ng-template>
      </p>
    </div>
    <div class="build-info">
      <p
        class="status"
        [ngClass]="{'status-blink': buildHistory.buildStatus == 5}"
        [appBuildHistoryStatus]="buildHistory.buildStatus">
        <i class="fas fa-hammer"></i> #{{buildHistory.number}} {{buildHistory.buildStatus | buildStatus}}
      </p>
      <p class="build-time"><i class="far fa-clock"></i> Duration {{buildHistory.duration | timespan}}</p>
      <p class="start-time" title="Finished {{buildHistory.buildAt | date:'medium'}}">
        <i class="far fa-calendar-alt"></i> Finished {{buildHistory.buildAt | dateAgo}}</p>
      <button class="btn btn-link restart-button" (click)="restartBuild()">
        <i class="fas fa-redo"></i>
        <span class="button-text"> Restart build</span></button>
    </div>
  </div>
  <app-logging-terminal [project]="project" [logs]="buildHistory.logs"></app-logging-terminal>
</div>
</ng-template>
<ng-template #emptyBuilds>
  <div class="container">

    <div class="no-builds-container">
      <div class="image-container">
        <img class="builders" [src]="'../../../../assets/images/Play.png'" />
      </div>
      <span class="my-3">
        It seems that you do not yet have builds for this project, you can run it at any time!
        </span>
    </div>
  </div>
</ng-template>
